# Plan: TodoUI React + Docker Implementation

Create a containerized React TypeScript frontend with Material-UI, TanStack Query, and Vite to interact with the Todo API. The UI will feature tabbed navigation for all/completed/overdue todos, inline editing, and a create form.

## Progress Checklist

- [x] **Step 1:** Setup TodoUI project structure
- [x] **Step 2:** Add Docker configuration
- [ ] **Step 3:** Define TypeScript types and API client
- [ ] **Step 4:** Implement TanStack Query hooks
- [ ] **Step 5:** Build main layout with tabs and create form
- [ ] **Step 6:** Implement todo list with inline editing

## Steps

1. **Setup TodoUI project structure** — Create `TodoUI` folder, initialize Vite React-TS project (`pnpm create vite TodoUI --template react-ts`), install dependencies (axios, @mui/material, @mui/icons-material, @tanstack/react-query, @emotion/react, @emotion/styled, @mui/x-date-pickers, dayjs), configure `TodoUI/.env` for `VITE_API_URL`.

2. **Add Docker configuration** — Create `TodoUI/Dockerfile` with Node 20 Alpine + pnpm (multi-stage: install deps, run dev server on port 5173), add `todoui` service to `docker-compose.yml` with ports `${UI_PORT}:5173`, volume mounts for hot reload, `API_URL` environment variable, depends on `api` service, add `UI_PORT` to `.env`.

3. **Define TypeScript types and API client** — Create `TodoUI/src/types` with `TodoItem`, `Category`, `CreateTodoItemRequest`, `UpdateTodoItemRequest` interfaces; create `TodoUI/src/api/client.ts` axios instance using `import.meta.env.VITE_API_URL`, add interceptors for error handling; create `TodoUI/src/api/endpoints.ts` with typed API functions.

4. **Implement TanStack Query hooks** — Create `TodoUI/src/hooks` with `useAllTodos`, `useCompletedTodos`, `useOverdueTodos`, `useCategories` (note: plan for GET `/api/categories` endpoint implementation later), `useCreateTodo`, `useUpdateTodo`, `useDeleteTodo` hooks; configure `TodoUI/src/main.tsx` with QueryClientProvider, set refetchOnWindowFocus and staleTime.

5. **Build main layout with tabs and create form** — Create `TodoUI/src/App.tsx` with Material-UI ThemeProvider, AppBar with title, `TodoUI/src/components/CreateTodoForm.tsx` (TextField for title, Autocomplete for category, DateTimePicker for dueTime, Button for submit), Tabs component ("All", "Completed", "Overdue") with TabPanel wrapper managing active view.

6. **Implement todo list with inline editing** — Create `TodoUI/src/components/TodoItem.tsx` as Material-UI Card with toggle states for inline editing (TextField for title, Autocomplete for category, DateTimePicker for dueTime with clear button), Checkbox for completion status (triggers `useUpdateTodo`), Chip for category badge, overdue warning icon/color, IconButton for delete with confirmation dialog, save/cancel buttons when editing.

## Further Considerations

1. **Category endpoint implementation** — After UI is functional, add GET `/api/categories` endpoint in `TodoApi/Controllers` to populate category dropdown; for now, `useCategories` can extract unique categories from todos or use a hardcoded list.

2. **Docker networking** — The `todoui` container will call API via `http://api:8080` internally, but browser requests from host need `http://localhost:${API_PORT}` — configure Vite proxy in `TodoUI/vite.config.ts` to forward `/api` requests, or use host-based API_URL.

3. **Error boundaries and loading states** — Add React error boundary wrapper, Material-UI Skeleton loaders for todo lists, Snackbar notifications for mutations success/failure using notistack library?

## API Structure Reference

### TodoItem Model

- **Id** (`int`) - Primary key
- **Title** (`string`) - Todo title
- **IsCompleted** (`bool`) - Completion status
- **CreatedAt** (`DateTime`) - Creation timestamp
- **DueTime** (`DateTime?`) - Optional due date/time
- **CategoryId** (`int?`) - Optional foreign key to Category
- **Category** - Navigation property to Category

### Category Model

- **Id** (`int`) - Primary key
- **Name** (`string`) - Category name

### API Endpoints

| HTTP Method | Endpoint                           | Purpose                            |
| ----------- | ---------------------------------- | ---------------------------------- |
| GET         | `/api/todos`                       | Get all todos with categories      |
| GET         | `/api/todos/{id}`                  | Get specific todo by ID            |
| GET         | `/api/todos/category/{categoryId}` | Get todos by category              |
| GET         | `/api/todos/completed`             | Get all completed todos            |
| GET         | `/api/todos/pending`               | Get all pending (incomplete) todos |
| GET         | `/api/todos/overdue`               | Get overdue todos                  |
| POST        | `/api/todos`                       | Create new todo                    |
| PUT         | `/api/todos/{id}`                  | Update existing todo (partial)     |
| DELETE      | `/api/todos/{id}`                  | Delete todo                        |

### Request DTOs

**CreateTodoItemRequest** (POST):

- `title` (required, 3-200 chars)
- `categoryId` (required, must be > 0 and exist)
- `dueTime` (optional, must be future date if provided)

**UpdateTodoItemRequest** (PUT - all optional for partial updates):

- `title` (3-200 chars if provided)
- `isCompleted` (bool)
- `categoryId` (must be > 0 and exist if provided)
- `dueTime` (must be future date if provided)

**TodoItemDto** (Response):

- `id`, `title`, `isCompleted`, `createdAt`, `dueTime`
- `category` (nested: `id`, `name`)

## Implementation Notes

### Folder Structure

- `src/pages/` - Container components that compose the main views (e.g., TodosPage)
- `src/components/` - Reusable UI components (e.g., TodoItem, CreateTodoForm, TabPanel)
- `src/types/` - TypeScript type definitions
- `src/api/` - API client and endpoint functions
- `src/hooks/` - Custom React hooks (TanStack Query hooks)

### Environment Variables

- `.env` file should include `UI_PORT` (e.g., 5173)
- `TodoUI/.env` should include `VITE_API_URL` pattern: `http://localhost:${API_PORT}`

### Inline Editing Approach

- Each TodoItem component maintains local edit state
- Toggle edit mode on click/edit button
- Show TextField, Autocomplete, DateTimePicker when editing
- Save button triggers `useUpdateTodo` mutation with changed fields only
- Cancel button reverts to original values

### Tab Views

- "All" tab: Shows all todos using `useAllTodos`
- "Completed" tab: Shows completed todos using `useCompletedTodos`
- "Overdue" tab: Shows overdue todos using `useOverdueTodos`
- Each tab handles its own loading/error states independently

### Optimistic Updates

- Create: Immediately add to list, rollback on error
- Update completion: Toggle checkbox immediately, rollback on error
- Delete: Remove from list immediately, rollback on error
- Invalidate queries on success to refetch fresh data
