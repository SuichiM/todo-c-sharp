# Plan: TodoUI React + Docker Implementation

Create a containerized React TypeScript frontend with Material-UI, TanStack Query, and Vite to interact with the Todo API. The UI will feature tabbed navigation for all/completed/overdue todos, inline editing, and a create form.

## Progress Checklist

### Phase 1: Project Setup

- [x] **Step 1:** Setup TodoUI project structure
- [x] **Step 2:** Add Docker configuration

### Phase 2: Read Operations (Listing Todos)

- [x] **Step 3:** Define TypeScript types for read operations
- [x] **Step 4:** Setup API client and fetch endpoints
- [x] **Step 5:** Implement TanStack Query hooks for fetching todos
- [x] **Step 6:** Setup main layout with ThemeProvider and AppBar
- [x] **Step 7:** Implement tabs (Pending, Completed, Overdue)
- [x] **Step 8:** Create TodoItem display component (read-only)

### Phase 3: Write Operations (Create, Update, Delete)

- [x] **Step 9:** Add types for write operations (Create/Update requests)
- [x] **Step 10:** Implement mutation hooks (create, update, delete)
- [x] **Step 11:** Create todo form component
- [x] **Step 12:** Implement inline editing functionality
- [x] **Step 13:** Add completion checkbox with update mutation
- [x] **Step 14:** Add delete functionality with confirmation

## Steps

### Phase 1: Project Setup âœ…

1. **Setup TodoUI project structure** â€” Create `TodoUI` folder, initialize Vite React-TS project (`pnpm create vite TodoUI --template react-ts`), install dependencies (axios, @mui/material, @mui/icons-material, @tanstack/react-query, @emotion/react, @emotion/styled, @mui/x-date-pickers, dayjs), configure `TodoUI/.env` for `VITE_API_URL`.

2. **Add Docker configuration** â€” Create `TodoUI/Dockerfile` with Node 20 Alpine + pnpm (multi-stage: install deps, run dev server on port 5173), add `todoui` service to `docker-compose.yml` with ports `${UI_PORT}:5173`, volume mounts for hot reload, `API_URL` environment variable, depends on `api` service, add `UI_PORT` to `.env`.

### Phase 2: Read Operations (Listing Todos) ðŸ”„

3. **Define TypeScript types for read operations** â€” Create `TodoUI/src/types/todo.ts` with `TodoItem` and `Category` interfaces matching API response structure (id, title, isCompleted, createdAt, dueTime, category).

4. **Setup API client and fetch endpoints** â€” Create `TodoUI/src/api/client.ts` axios instance using `import.meta.env.VITE_API_URL`, add interceptors for error handling; create `TodoUI/src/api/todos.ts` with GET functions: `fetchPendingTodos()`, `fetchCompletedTodos()`, `fetchOverdueTodos()`.

5. **Implement TanStack Query hooks for fetching todos** â€” Create `TodoUI/src/hooks/useTodos.ts` with `usePendingTodos`, `useCompletedTodos`, `useOverdueTodos` hooks; configure `TodoUI/src/main.tsx` with QueryClientProvider, set refetchOnWindowFocus and staleTime.

6. **Setup main layout with ThemeProvider and AppBar** â€” Create `TodoUI/src/App.tsx` with Material-UI ThemeProvider, AppBar with title "Todo App", Container for main content area.

7. **Implement tabs (Pending, Completed, Overdue)** â€” Add Tabs component to App.tsx with three tabs: "Pending", "Completed", "Overdue"; create `TodoUI/src/components/TabPanel.tsx` wrapper component that conditionally renders content based on active tab, handles loading/error states for each view.

8. **Create TodoItem display component (read-only)** â€” Create `TodoUI/src/components/TodoItem.tsx` as Material-UI Card displaying title, category Chip, creation date, due date with overdue indicator (red color/icon if past due), completion status indicator (no checkbox yet, just visual indicator).

### Phase 3: Write Operations (Create, Update, Delete) â³

9. **Add types for write operations** â€” Add `CreateTodoItemRequest` and `UpdateTodoItemRequest` interfaces to `TodoUI/src/types/todo.ts`.

10. **Implement mutation hooks** â€” Create `TodoUI/src/hooks/useTodoMutations.ts` with `useCreateTodo`, `useUpdateTodo`, `useDeleteTodo` hooks with optimistic updates and query invalidation.

11. **Create todo form component** â€” Create `TodoUI/src/components/CreateTodoForm.tsx` with TextField for title, Autocomplete for category (extract from existing todos for now), DateTimePicker for dueTime, Button for submit; position at top of page.

12. **Implement inline editing functionality** â€” âœ… Enhanced `TodoItem` component with independent field editing: click title to edit inline (save on blur/Enter), click category chip to change via dropdown, click due time to edit with DateTimePicker (saves on OK button); all fields update independently using `useUpdateTodo` mutation.

13. **Add completion checkbox with update mutation** â€” âœ… Added Checkbox to left side of `TodoItem` for toggling completion status, wired to `useUpdateTodo` mutation; completed todos show strikethrough title and grayed text; removed redundant "Completed" chip.

14. **Add delete functionality with confirmation** â€” âœ… Added delete IconButton (trash icon) next to category chip; clicking opens Material-UI Dialog with confirmation message; Delete button triggers `useDeleteTodo` mutation; dialog closes on success; button disabled during deletion with "Deleting..." text.

## Further Considerations

1. **Category endpoint implementation** â€” After UI is functional, add GET `/api/categories` endpoint in `TodoApi/Controllers` to populate category dropdown; for now, `useCategories` can extract unique categories from todos or use a hardcoded list.

2. **Docker networking** â€” The `todoui` container will call API via `http://api:8080` internally, but browser requests from host need `http://localhost:${API_PORT}` â€” configure Vite proxy in `TodoUI/vite.config.ts` to forward `/api` requests, or use host-based API_URL.

3. **Error boundaries and loading states** â€” Add React error boundary wrapper, Material-UI Skeleton loaders for todo lists, Snackbar notifications for mutations success/failure using notistack library?

## API Structure Reference

### TodoItem Model

- **Id** (`int`) - Primary key
- **Title** (`string`) - Todo title
- **IsCompleted** (`bool`) - Completion status
- **CreatedAt** (`DateTime`) - Creation timestamp
- **DueTime** (`DateTime?`) - Optional due date/time
- **CategoryId** (`int?`) - Optional foreign key to Category
- **Category** - Navigation property to Category

### Category Model

- **Id** (`int`) - Primary key
- **Name** (`string`) - Category name

### API Endpoints

| HTTP Method | Endpoint                           | Purpose                            |
| ----------- | ---------------------------------- | ---------------------------------- |
| GET         | `/api/todos`                       | Get all todos with categories      |
| GET         | `/api/todos/{id}`                  | Get specific todo by ID            |
| GET         | `/api/todos/category/{categoryId}` | Get todos by category              |
| GET         | `/api/todos/completed`             | Get all completed todos            |
| GET         | `/api/todos/pending`               | Get all pending (incomplete) todos |
| GET         | `/api/todos/overdue`               | Get overdue todos                  |
| POST        | `/api/todos`                       | Create new todo                    |
| PUT         | `/api/todos/{id}`                  | Update existing todo (partial)     |
| DELETE      | `/api/todos/{id}`                  | Delete todo                        |

### Request DTOs

**CreateTodoItemRequest** (POST):

- `title` (required, 3-200 chars)
- `categoryId` (required, must be > 0 and exist)
- `dueTime` (optional, must be future date if provided)

**UpdateTodoItemRequest** (PUT - all optional for partial updates):

- `title` (3-200 chars if provided)
- `isCompleted` (bool)
- `categoryId` (must be > 0 and exist if provided)
- `dueTime` (must be future date if provided)

**TodoItemDto** (Response):

- `id`, `title`, `isCompleted`, `createdAt`, `dueTime`
- `category` (nested: `id`, `name`)

## Implementation Notes

### Folder Structure

- `src/pages/` - Container components that compose the main views (e.g., TodosPage)
- `src/components/` - Reusable UI components (e.g., TodoItem, CreateTodoForm, TabPanel)
- `src/types/` - TypeScript type definitions
- `src/api/` - API client and endpoint functions
- `src/hooks/` - Custom React hooks (TanStack Query hooks)

### Environment Variables

- `.env` file should include `UI_PORT` (e.g., 5173)
- `TodoUI/.env` should include `VITE_API_URL` pattern: `http://localhost:${API_PORT}`

### Inline Editing Approach

- Each TodoItem component maintains local edit state
- Toggle edit mode on click/edit button
- Show TextField, Autocomplete, DateTimePicker when editing
- Save button triggers `useUpdateTodo` mutation with changed fields only
- Cancel button reverts to original values

### Tab Views

- "All" tab: Shows all todos using `useAllTodos`
- "Completed" tab: Shows completed todos using `useCompletedTodos`
- "Overdue" tab: Shows overdue todos using `useOverdueTodos`
- Each tab handles its own loading/error states independently

### Optimistic Updates

- Create: Immediately add to list, rollback on error
- Update completion: Toggle checkbox immediately, rollback on error
- Delete: Remove from list immediately, rollback on error
- Invalidate queries on success to refetch fresh data
